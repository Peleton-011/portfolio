---
import { LANGUAGES } from "../i18n/ui";

const LOADED_LANGUAGES = await Promise.all(
	LANGUAGES.map((c) => import("./languages/" + c.icon + ".astro"))
);

console.log("ABC")

console.log(LOADED_LANGUAGES);

interface props {
	showName?: boolean;
	showLocation?: boolean;
}

const { showName, showLocation } = Astro.props;
---

<div
	class="flex items-center md:order-2 space-x-1 md:space-x-0 rtl:space-x-reverse"
>
	<script
		src="https://cdn.jsdelivr.net/npm/flowbite@3.1.1/dist/flowbite.min.js"
	></script>
	<!-- Default language -->
	<button
		type="button"
		data-dropdown-toggle="language-dropdown-menu"
		class="inline-flex items-center font-medium justify-center text-sm rounded-lg cursor-pointer"
	>
		{
			LOADED_LANGUAGES.filter((v, i) => i === 0).map((language) => (
				<>
					{language.icon && <language.icon.default class="size-7 me-3" />}
					{showName && (
						<span class="hidden md:block">{language.name}</span>
					)}
					{showLocation && (
						<span class="hidden lg:block">
							&nbsp; ({language.location})
						</span>
					)}
				</>
			))
		}
	</button>
	<!-- Dropdown -->
	<div
		class="z-50 hidden my-4 text-base list-none bg-white divide-y divide-gray-100 rounded-lg shadow-sm dark:bg-gray-700"
		id="language-dropdown-menu"
	>
		<ul class="py-2 font-medium" role="none">
			{
				LOADED_LANGUAGES.map((language) => (
					<li>
						<a
							href="#"
							class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-white"
							role="menuitem"
						>
							<div class="inline-flex items-center">
								{language.icon && (
									<language.icon class="size-7 me-3" />
								)}
								{showName && (
									<span class="hidden md:block">
										{language.name}
									</span>
								)}
								{showLocation && (
									<span class="hidden lg:block">
										&nbsp; ({language.location})
									</span>
								)}
							</div>
						</a>
					</li>
				))
			}
		</ul>
	</div>
</div>
